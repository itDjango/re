(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-793dd702"],{1715:function(t,s,e){"use strict";var o=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"icon",on:{click:t.back}},[e("van-icon",{staticClass:"arrow",attrs:{name:"arrow-left"}})],1)},a=[],i={methods:{back(){this.$emit("back")}}},n=i,c=(e("6036"),e("2877")),r=Object(c["a"])(n,o,a,!1,null,"31a621cf",null);s["a"]=r.exports},3911:function(t,s,e){},5307:function(t,s,e){t.exports=e.p+"img/vue.63050d8a.jpg"},6036:function(t,s,e){"use strict";var o=e("3911"),a=e.n(o);a.a},"7bf9":function(t,s,e){"use strict";var o=e("b946"),a=e.n(o);a.a},"9f52":function(t,s,e){"use strict";e.r(s);var o=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"goods"},[e("van-goods-action",{staticClass:"van-goods-sku"},[e("van-goods-action-icon",{attrs:{icon:"wap-home"},on:{click:t.goHome}},[t._v("首 页")]),e("van-goods-action-icon",{attrs:{icon:"shopping-cart-o"},on:{click:t.onClickCart}},[t._v("购物车")]),e("van-goods-action-button",{attrs:{type:"warning"},on:{click:t.addShops}},[t._v("加入购物车")]),e("van-goods-action-button",{attrs:{type:"danger"},on:{click:t.purchase}},[t._v("开始拼团")])],1),e("Scroll",{ref:"scroll",staticClass:"scroll",attrs:{bounce:t.bounce,pullup:!0},on:{scrollToEnd:t.scrollToEnd}},[e("div",[e("van-swipe",{staticClass:"goods-swipe",attrs:{autoplay:3e3,touchable:!1},on:{change:t.onChange}},[e("van-swipe-item",[e("img",{ref:"swiperImg",attrs:{src:t.goods.image,onerror:t.defaultImg},on:{click:t.showImagePreview}})]),e("van-swipe-item",[e("img",{ref:"swiperImg2",attrs:{src:t.goods.image,onerror:t.defaultImg},on:{click:t.showImagePreview}})]),e("div",{staticClass:"custom-indicator",attrs:{slot:"indicator"},slot:"indicator"},[t._v(t._s(t.current+1)+"/2")])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showFlag,expression:"!showFlag"}]},[e("van-cell-group",[e("van-cell",{staticClass:"titlename"},[e("div",{staticClass:"goods-title"},[t._v(t._s(t.goods.name))]),e("div",{staticClass:"goods-price"},[t._v("￥"+t._s(t.goods.present_price))])]),e("van-cell",{staticClass:"goods-express"},[e("van-col",{attrs:{span:"9"}},[t._v("运费："+t._s(t.goods.express||0))]),e("van-col",{attrs:{span:"9"}},[t._v("剩余："+t._s(t.goods.amount))]),e("van-col",{staticClass:"like",attrs:{span:"6"}},[t._v("\n              "+t._s(t.isCollectionFlag?"收藏":"取消收藏")+"：\n              "),e("van-icon",{staticClass:"like-o",class:{like2:!t.isCollectionFlag},attrs:{name:t.isCollectionFlag?"like-o":"like"},on:{click:t.collection}})],1)],1)],1),e("div",[e("van-tabs",{staticClass:"datails-tabs",model:{value:t.currentActive,callback:function(s){t.currentActive=s},expression:"currentActive"}},t._l(t.item,(function(s){return e("van-tab",{key:s.id,attrs:{title:s.title}},[e("div",{directives:[{name:"show",rawName:"v-show",value:0==t.currentActive,expression:"currentActive == 0"}],staticClass:"active-0",domProps:{innerHTML:t._s(t.goodsDetails.detail||t.goods.detail)}}),e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.currentActive,expression:"currentActive == 1"}],staticClass:"active-1"},[t._l(t.dataArr,(function(s){return e("div",{key:s._id,staticClass:"comment"},[e("div",{staticClass:"comment-content"},[e("div",{staticClass:"avatar"},[s.anonymous?e("img",{attrs:{src:s.comment_avatar,alt:"",srcset:""}}):e("img",{attrs:{src:s.user[0].avatar,onerror:t.defaultImg,alt:"",srcset:""}})]),e("div",{staticClass:"desc border-bottom"},[e("p",{staticClass:"fist"},[s.anonymous?e("span",{staticClass:"name"},[t._v(t._s(s.comment_nickname)+"：")]):e("span",{staticClass:"name"},[t._v(t._s(s.user[0].nickname)+"：")]),e("span",{staticClass:"num"},[t._v(t._s(s.comment_time))])]),e("p",{staticClass:"timer"},[e("van-rate",{attrs:{readonly:"",size:12,color:"#e0322b"},model:{value:s.rate,callback:function(e){t.$set(s,"rate",e)},expression:"val.rate"}})],1),e("p",{staticClass:"cont"},[t._v(t._s(s.content))]),e("div",{staticClass:"img-content",class:t.setImgContentClass(s.images.length)},t._l(s.images,(function(o){return e("img",{key:o,staticClass:"img",class:t.setImgClass(s.images.length),attrs:{src:o}})})),0)])])])})),t.dataArr.length?t._e():e("div",{staticClass:"nocomment"},[t._v("该商品暂无评论噢~~")])],2)])})),1)],1)],1)],1)]),e("transition",{attrs:{name:"bounce2"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showBase,expression:"showBase"}],staticClass:"sku",class:{sku2:t.showBase}},[e("van-icon",{staticClass:"close",attrs:{name:"close"},on:{click:function(s){t.showBase=!1}}}),e("div",{staticClass:"goods-top border-bottom"},[e("img",{staticClass:"image_path",attrs:{src:t.goods.image_path,onerror:t.defaultImg}}),e("div",{staticClass:"goods-right"},[e("p",{staticClass:"goods-name"},[t._v(t._s(t.goods.name))]),e("p",{staticClass:"pic"},[e("span",[t._v("￥")]),e("span",[t._v(t._s(t._f("toFixed")(t.goods.present_price*t.newCount)))])])])]),e("div",{staticClass:"goods-bottom border-bottom"},[e("div",{staticClass:"left"},[e("p",{staticClass:"num"},[t._v("购买数量：")]),e("p",{staticClass:"totle"},[t._v("\n            剩余 "+t._s(t.goods.amount)+" 件\n            "),e("span",[t._v("每人限购50件")])])]),e("AdditionAndSubtraction",{on:{count:t.count}})],1),e("div",{staticClass:"bottom",on:{click:t.PurchaseImmediately}},[t._v("立即拼团")])],1)]),e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showBase,expression:"showBase"}],staticClass:"sku-layer",on:{click:function(s){t.showBase=!1}}})]),e("BaseLoding",{attrs:{showFlag:t.showFlag}}),e("Back",{on:{back:t.back}})],1)},a=[],i=e("1da1"),n=e("9134"),c=e("1715"),r=e("3d93"),l=e("28a2"),d=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"right"},[e("button",{staticClass:"van-stepper__minus add",class:{"van-stepper__minus--disabled":1==t.count},on:{click:t.minus}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.count,expression:"count"}],staticClass:"van-stepper__input",attrs:{type:"number",disabled:""},domProps:{value:t.count},on:{input:function(s){s.target.composing||(t.count=s.target.value)}}}),e("button",{staticClass:"van-stepper__plus",class:{"van-stepper__plus--disabled":15==t.count},on:{click:t.plus}})])},u=[],m={data(){return{count:1}},methods:{minus(){1!=this.count?this.count--:$toast("至少选择1件~~")},plus(){this.count>=50?$toast("最多选择50件噢~~"):this.count++}},watch:{count(t){this.$emit("count",t)}}},g=m,h=(e("f0c1"),e("2877")),v=Object(h["a"])(g,d,u,!1,null,"ab7aee74",null),p=v.exports,C={name:"Details",props:["id"],mixins:[r["a"],r["b"]],components:{Back:c["a"],AdditionAndSubtraction:p,Scroll:n["a"]},data(){return{goods:{},defaultImg:'this.src="'+e("5307")+'"',currentActive:0,item:[{id:0,title:"商品详情"},{id:1,title:"商品评论"}],isCollectionFlag:!1,showBase:!1,newCount:1,comment:"",current:0,page:1,bounce:{bottom:!1}}},methods:{formatPrice(){return"¥"+(this.goods.price/100).toFixed(2)},onChange(t){this.current=t},onClickCart(){this.$router.push({name:"ShoppingCart"})},goHome(){this.$router.push({name:"Home"})},setImgClass(t){return`img${t}`},setImgContentClass(t){return`img-content${t}`},goodsItem(){var t=this,s=arguments;return Object(i["a"])((function*(){let e=s.length>0&&void 0!==s[0]?s[0]:t.goodsDetails.goodsId,o=s.length>1&&void 0!==s[1]&&s[1];try{if(t.isLocked())return;t.locked();const s=yield t.Api.goodOne(e,t.page),a=s.data;200==a.code&&(t.setTotal(a.goods.count),t.unLocked(),t.$refs.swiperImg.style.opacity=1,t.$refs.swiperImg2.style.opacity=1,a.goods.goodsOne&&(document.title=a.goods.goodsOne.name,t.goods=a.goods.goodsOne,setTimeout(()=>{t.setBrowse(a.goods.goodsOne)},300)),o?t.setNewData(a.goods.comment):t.dataArr=a.goods.comment)}catch(a){t.showFlag=!1,t.isCollectionFlag=!0,t.unLocked(),t.$toast("网络错误")}}))()},scrollToEnd(){setTimeout(()=>{this.$refs.scroll.refresh()},20),1==this.currentActive&&this.dataArr.length>=5&&(this.page++,this.hasMore()?this.goodsItem(this.id,!0):this.$toast("没有更多评论了~~"))},isCollection(t){var s=this;return Object(i["a"])((function*(){try{s.showFlag=!0;const e=yield s.Api.isCollection(t),o=e.data;200==o.code?(s.showFlag=!1,1==o.isCollection?s.isCollectionFlag=!1:s.isCollectionFlag=!0):(s.showFlag=!1,s.isCollectionFlag=!0)}catch(e){s.showFlag=!1}}))()},collection(){var t=this;return Object(i["a"])((function*(){if(t.userName)if(t.isCollectionFlag){let e=t.goods;delete e["_id"];try{const s=yield t.Api.collection(e),o=s.data;200==o.code&&(t.$toast(o.msg),t.isCollectionFlag=!1)}catch(s){t.$toast("收藏失败,网络错误")}}else try{const s=yield t.Api.cancelCollection(t.goods.id),e=s.data;200==e.code&&(t.isCollectionFlag=!0)}catch(s){t.$toast("网络错误")}else t.$router.push({name:"Login"})}))()},addShops(){var t=this;return Object(i["a"])((function*(){if(t.userName)try{const s=yield t.Api.addShop(t.goodsDetails.goodsId||t.goodsDetails.id),e=s.data;200==e.code&&t.$toast(e.msg)}catch(s){t.$toast("网络错误")}else t.$router.push({name:"Login"})}))()},purchase(){this.showBase=!0},count(t){this.newCount=t},PurchaseImmediately(){if(!this.userName)return void this.$router.push({name:"Login"});let t=[{check:!0,count:this.newCount,cid:this.goods.id,image_path:this.goods.image_path,mallPrice:this.goods.present_price*this.newCount,present_price:this.goods.present_price,name:this.goods.name,idDirect:!0,count:this.newCount}];this.$router.push({name:"ShoppingPayMent"}),this.setShopList(t)},showImagePreview(){Object(l["a"])({images:[this.goods.image,this.goods.image],startPosition:0,showIndicators:!0})}},created(){this.goodsItem(this.id),this.isCollection(this.goodsDetails.goodsId||this.goodsDetails.id||this.id)},activated(){this.goodsItem(this.id),this.isCollection(this.id)},deactivated(){setTimeout(()=>{this.goods={},this.dataArr=[]},500)},mounted(){document.querySelector(".van-tabs__line").classList.add("swip"),this.$refs.swiperImg.style.opacity=0,this.$refs.swiperImg2.style.opacity=0},watch:{currentActive(t,s){1==t?(document.querySelector(".van-tabs__line").classList.remove("swip"),this.bounce.bottom=!0):this.bounce.bottom=!1}}},_=C,w=(e("7bf9"),Object(h["a"])(_,o,a,!1,null,"471161b9",null));s["default"]=w.exports},b749:function(t,s,e){},b946:function(t,s,e){},f0c1:function(t,s,e){"use strict";var o=e("b749"),a=e.n(o);a.a}}]);